@page
@model QLMH.Pages.CartModel
@{
    ViewData["Title"] = "Giỏ hàng";
}

<section class="h-100" style="background-color: #f8f9fa;">
  <div class="container py-5 h-100">
    <div class="row d-flex justify-content-center align-items-start h-100">
      
      <div class="col-12">
        <h2 class="mb-4 fw-bold">Giỏ hàng của bạn</h2>
      </div>

      <div class="col-lg-8">
        @if (Model.Cart != null && Model.Cart.Count > 0)
        {
            @foreach (var item in Model.Cart)
            {
                <div class="card rounded-3 mb-4 shadow-sm">
                  <div class="card-body p-4">
                    <div class="row d-flex justify-content-between align-items-center">
                      <div class="col-md-2 col-lg-2 col-xl-2">
                        <img src="@(string.IsNullOrEmpty(item.ImageUrl) ? "https://dummyimage.com/450x300/dee2e6/6c757d.jpg" : item.ImageUrl)"
                          class="img-fluid rounded-3" alt="@item.ProductName">
                      </div>
                      
                      <div class="col-md-3 col-lg-3 col-xl-3">
                        <p class="lead fw-normal mb-2">@item.ProductName</p>
                        <span class="text-muted small">Đơn giá: @item.Price.ToString("N0") đ</span>
                      </div>
                      
                      <div class="col-md-3 col-lg-3 col-xl-2 d-flex">
                         <input type="number" class="form-control form-control-sm text-center" 
                                value="@item.Quantity" readonly style="background-color: #fff;" />
                      </div>
                      
                      <div class="col-md-3 col-lg-2 col-xl-2 offset-lg-1">
                        <h5 class="mb-0 fw-bold">@((item.Price * item.Quantity).ToString("N0")) đ</h5>
                      </div>
                      
                      <div class="col-md-1 col-lg-1 col-xl-1 text-end">
                        <a asp-page="Cart" asp-page-handler="Delete" asp-route-id="@item.ProductId" class="text-danger fs-5">
                            <i class="bi bi-trash-fill"></i>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
            }
        }
        else
        {
             <div class="alert alert-warning text-center p-5">
                 <h4>Giỏ hàng trống trơn!</h4>
                 <p>Hãy dạo một vòng cửa hàng và chọn những món đồ ưng ý nhé.</p>
                 <a asp-page="/Index" class="btn btn-warning mt-3">Tiếp tục mua sắm</a>
             </div>
        }
      </div>

      @if (Model.Cart != null && Model.Cart.Count > 0)
      {
          <div class="col-lg-4">
            <div class="card shadow-sm rounded-3">
              <div class="card-body p-4">
                <h4 class="fw-bold mb-4">Cộng giỏ hàng</h4>
                
                <div class="d-flex justify-content-between mb-4">
                  <h5 class="text-muted">Tổng tiền hàng:</h5>
                  <h5>@Model.TotalAmount.ToString("N0") VNĐ</h5>
                </div>
                
                <hr class="my-4">
                
                <div class="d-flex justify-content-between mb-5">
                  <h4 class="fw-bold">Thành tiền:</h4>
                  <h4 class="fw-bold text-success">@Model.TotalAmount.ToString("N0") VNĐ</h4>
                </div>

                <div class="d-grid gap-2">
                    <a asp-page="/Checkout" class="btn btn-warning btn-block btn-lg fw-bold">
                        Tiến hành Thanh toán
                    </a>
                    <a asp-page="/Index" class="btn btn-outline-secondary btn-block">
                        Tiếp tục xem hàng
                    </a>
                </div>

              </div>
            </div>
          </div>
      }

    </div>
  </div>
</section>